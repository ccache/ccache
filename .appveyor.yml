# Notes:
# See https://ci.appveyor.com/tools/validate-yaml for syntax validation.

# Simple versioning scheme
version: '{build}'

# Check compilation both on 32 and 64 bit platforms
platform:
    - x64
    - x86

# Try compilation with the three current compilers available
image:
    - Visual Studio 2015
    - Visual Studio 2017
#   - Visual Studio 2013

# Run AppVeyor only on the windows branch, until we are merged to trunk
branches:
    only:
        - windows

# Stops on first failing combination
matrix:
  fast_finish: true

install:
    # Have Visual 2015 compiler (cl.exe) in path
    - 'C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\bin\x86_amd64\vcvarsx86_amd64.bat'

    # Have MSYS2 in path
    - set PATH=C:\MSYS64\usr\bin;%PATH%

    # Install needed packages from MSYS2
    - pacman -S --needed --noconfirm autoconf make perl

build_script:
    - export LC_ALL=C
    - ./autogen.sh
    - ./configure
    - make

test_script:
    - MSYS make test
